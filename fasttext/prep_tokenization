#import pandas as pd
#import numpy as np
import re
import fasttext
from spacy.lang.af import Afrikaans

nlp = Afrikaans()

with open('/my_path/sesotho_corpus.txt', 'r', encoding ='UTF8') as file:
    corpus = file.readlines()
    tokens_updated = []
    for sent in corpus:
        sent = re.sub(r"[^a-z0-9]+",' ', sent.lower())
        #print("sent:", sent)
        doc = nlp(sent)
        #print("doc",doc)
        tokens = [token.text for token in doc]
        #print(tokens)
        tokens_updated.extend(tokens)
    #corpus_tokenzied = ' '.join(tokens_updated)
    #print(corpus_tokenzied)
    #print(tokens_updated)

with open('corpus_preprocessed.txt','w') as f_output:
    corpus_tokenized = ' '.join(tokens_updated)
    f_output.write(corpus_tokenized)


model = fasttext.train_unsupervised('corpus_preprocessed.txt', model='skipgram', epoch=25, lr=0.1, minCount=1, dim=300)
model.save_model('/my_path/tokenized_skipgram_lr=0.1') #modify parameters
print("training finished")

print("neighborhood test")
model.get_nearest_neighbors('ntate')
model.get_nearest_neighbors('afrika')
model.get_nearest_neighbors('apole')

print("analogy test")
model.get_analogies('berlin','germany','france')
model.get_analogies('morena','motho','mosadi')
model.get_analogies('iphone','apple','samsung')
